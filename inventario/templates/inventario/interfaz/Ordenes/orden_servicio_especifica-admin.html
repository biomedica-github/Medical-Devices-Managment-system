{%extends "../base_PUT-DELETE-ESPECIFICO.html"%}
{% load static%}
{%load rest_framework%}

{%block ordenactivo%} active {%endblock%}

    {%block anuncioModificado%}
    <span><strong>Orden modificada de forma exitosa</strong></span>
    {%endblock%}
                    {%block botones%}
                    <div class="row">
                        <div class="col text-end">
                            {%if user.is_staff%}
                            <div class="btn-group flex-wrap" role="group"><button class="btn btn-danger" type="button" style="margin: 10px;" data-bs-target="#modal-2" data-bs-toggle="modal"><i class="fas fa-trash" style="margin-right: 10px;"></i>Borrar Orden de Servicio</button>
                            {%endif%}
                                {%if contenido.orden_escaneada%}<a class="btn btn-secondary" target="_blank" href="{{contenido.orden_escaneada}}" role="button" style="margin: 10px;"><i class="fas fa-file-pdf" style="margin-right: 10px;"></i>Ver PDF Orden Servicio</a>
                                {%else%}
                                <a class="btn btn-secondary disabled"  role="button" style="margin: 10px;"><i class="fas fa-file-pdf" style="margin-right: 10px;"></i>Orden sin PDF escaneado</a>
                                {%endif%}
                                {%if user.is_staff%}
                                <button class="btn btn-primary" type="button" data-bs-target="#modal-1" data-bs-toggle="modal" style="margin: 10px;"><i class="far fa-edit" style="margin-right: 10px;"></i>Actualizar orden de servicio</button></div>
                                {%endif%}
                            </div>
                    </div>
                    {%endblock%}
                    {%block body%}
                    <div class="col">
                        <p style="font-size: 36px;"><strong><span style="color: rgb(37, 126, 62);">Orden de servicio {{contenido.numero_orden}}</span></strong></p>
                    </div>
                    <div class="row">
                        <div class="col" style="margin-top: 10px;">
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="color: rgb(37,126,62);border-color: var(--bs-warning-text-emphasis);font-size: 14.2px;">Fecha de realizacion</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><span>{{contenido.fecha}}</span></div>
                                        </div>
                                        <div class="col-auto"><span></span></div>
                                    </div>
                                </div>
                            </div>
                            {%if contenido.fallo_paciente%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px; background-color: var(--bs-form-invalid-color);">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="font-size: 13.2px;color: var(--bs-success-text-emphasis);">Fallo con paciente</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><a class="nav-link active" style="font-size: 20px;">Este equipo fallo mientras un paciente lo utilizaba</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%else%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px; background-color: var(--bs-success);">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="font-size: 13.2px;color: var(--bs-success-text-emphasis);">Fallo con paciente</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><a class="nav-link active" style="font-size: 20px;">Este equipo NO fallo mientras un paciente lo utilizaba</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.motivo%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="font-size: 13.2px;color: var(--bs-success-text-emphasis);">Motivo</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><a class="nav-link active" style="font-size: 20px;">{{contenido.motivo}}</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.tipo_orden%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1" style="font-size: 13.2px;"><span style="color: var(--bs-success-text-emphasis);">Tipo de orden</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><span>{{contenido.tipo_orden}}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.responsable%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="font-size: 13.2px;color: var(--bs-success-text-emphasis);">Responsable</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><a class="nav-link active"style="font-size: 20px;">{{contenido.responsable}}</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.descripcion_servicio%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="color: var(--bs-success-text-emphasis);font-size: 13.2px;">Descripcion del servicio</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><span>{{contenido.descripcion_servicio}}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.equipo_complementario%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="color: var(--bs-success-text-emphasis);font-size: 13.2px;">Equipo complementario</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><span>{{contenido.equipo_complementario}}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.ing_realizo%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="color: var(--bs-success-text-emphasis);font-size: 13.2px;">Ing, que realizo servicio</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><span>{{contenido.ing_realizo}}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                            {%if contenido.num_mantenimiento_preventivo%}
                            <div class="card shadow border-start-warning py-2" style="margin: 10px;">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span style="color: var(--bs-success-text-emphasis);font-size: 13.2px;">Numero de mantenimiento preventivo</span></div>
                                            <div class="text-dark fw-bold h5 mb-0"><span>{{contenido.num_mantenimiento_preventivo}}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {%endif%}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <p style="font-size: 36px;"><strong><span style="color: rgb(37, 126, 62);">Equipo(s) en orden de servicio.</span></strong></p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            {%for equipo in contenido.equipo_medico%}
                            <div class="card mx-auto" href="www.google.com" style="margin: 10px;">
                                <div class="card-body border rounded-0 d-inline-flex justify-content-between flex-wrap p-2">
                                    <div class="d-inline ms-0 text-break"><a class="text-break fs-4 d-inline text-decoration-none stretched-link text-break" 
                                        {%if user.is_staff%}
                                        href="/equipo_medico/general/{{equipo.id}}"
                                        {%else%}
                                        href="/area/general/{{area_id}}/equipos_area/{{equipo.id}}/"
                                        {%endif%}
                                        ><strong><span style="color: rgb(37, 126, 62); background-color: rgb(248, 249, 252);">NNI: {{equipo.numero_nacional_inv}}</span></strong><br /><strong><span style="color: rgb(37, 126, 62); background-color: rgb(248, 249, 252);">{{equipo.nombre_equipo}} {%if equipo.cama%} Cama#{{equipo.cama}} {%else%} Equipo sin cama asignada {%endif%}</span></strong></a>
                                        <p>Marca: {{equipo.marca}} | Modelo:{{equipo.modelo}} | Num.Serie: {{equipo.numero_serie}} </p>
                                    </div>
                                    <div class="d-inline ms-0 text-break">
                                        <p class="text-center" style="text-decoration: underline;">Area</p>
                                        <p class="text-center d-block text-break">{{equipo.area}}</p>
                                    </div>
                                    <div class="text-center d-inline ms-2"><a class="fs-4 text-decoration-none" href="#"></a>
                                        <p class="text-black-50" style="text-decoration: underline;">Estado</p>
                                        <p class="d-inline text-break" style="font-size: 16px;">{{equipo.estado}}</p>
                                    </div>
                                </div>
                            </div>
                            {%endfor%}
                        </div>
                    </div>
                    {%endblock%}


                    {%if user.is_staff%}
                    {%block modales%}
                    <div class="modal fade" role="dialog" tabindex="-1" id="modal-1">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Actualizar Orden de servicio</h4><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    {%if putserializer%}
                                    <form id="put-form" action="{{request.build_absolute_uri}}">
                                        {%csrf_token%}
                                        <fieldset>
                                            {% render_form putserializer template_pack='/form-fields' %}
                                            <div class="modal-footer"><button class="btn btn-light" type="button" data-bs-dismiss="modal">Cerrar</button><button class="btn btn-primary" type="submit">Guardar</button></div>
                                        </fieldset>
                                    </form>
                                    {%endif%}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" role="dialog" tabindex="-1" id="modal-2">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title" style="font-size: 30px;">Eliminar Orden de Servicio</h4><button class="btn-close" type="button" aria-label="Close" data-bs-dismiss="modal"></button>
                                </div>
                                {%csrf_token%}
                                <div class="modal-body"><span style="font-size: 20px;">Estas a punto de eliminar esta orden de servicio de la base de datos de forma permanente. ¿Estas seguro que deseas continuar?</span></div>
                                <div class="modal-footer"><button class="btn btn-light" type="button" data-bs-dismiss="modal">Cerrar</button><button id="del-btn" class="btn btn-danger text-end" type="submit">Eliminar</button></div>
                            </div>
                        </div>
                    </div>
                    {%endblock%}
                    {%endif%}